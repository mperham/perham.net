<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>Mutterings: Fun with .NET Web Service Clients</title>

<link rel="stylesheet" href="http://www.perham.net/mike/log/styles-site.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.perham.net/mike/log/index.rdf" />

<link rel="start" href="http://www.perham.net/mike/log/" title="Home" />
<link rel="prev" href="http://www.perham.net/mike/log/archives/000174.html" title="It's in the Middle there Somewhere..." />

<link rel="next" href="http://www.perham.net/mike/log/archives/000176.html" title="Avoiding the Fuzz" />


<script type="text/javascript" language="javascript">
<!--

function OpenTrackback (c) {
    window.open(c,
                    'trackback',
                    'width=480,height=480,scrollbars=yes,status=yes');
}

var HOST = 'www.perham.net';

// Copyright (c) 1996-1997 Athenia Associates.
// http://www.webreference.com/js/
// License is granted if and only if this entire
// copyright notice is included. By Tomer Shiran.

function setCookie (name, value, expires, path, domain, secure) {
    var curCookie = name + "=" + escape(value) + ((expires) ? "; expires=" + expires.toGMTString() : "") + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + ((secure) ? "; secure" : "");
    document.cookie = curCookie;
}

function getCookie (name) {
    var prefix = name + '=';
    var c = document.cookie;
    var nullstring = '';
    var cookieStartIndex = c.indexOf(prefix);
    if (cookieStartIndex == -1)
        return nullstring;
    var cookieEndIndex = c.indexOf(";", cookieStartIndex + prefix.length);
    if (cookieEndIndex == -1)
        cookieEndIndex = c.length;
    return unescape(c.substring(cookieStartIndex + prefix.length, cookieEndIndex));
}

function deleteCookie (name, path, domain) {
    if (getCookie(name))
        document.cookie = name + "=" + ((path) ? "; path=" + path : "") + ((domain) ? "; domain=" + domain : "") + "; expires=Thu, 01-Jan-70 00:00:01 GMT";
}

function fixDate (date) {
    var base = new Date(0);
    var skew = base.getTime();
    if (skew > 0)
        date.setTime(date.getTime() - skew);
}

function rememberMe (f) {
    var now = new Date();
    fixDate(now);
    now.setTime(now.getTime() + 365 * 24 * 60 * 60 * 1000);
    setCookie('mtcmtauth', f.author.value, now, '', HOST, '');
    setCookie('mtcmtmail', f.email.value, now, '', HOST, '');
    setCookie('mtcmthome', f.url.value, now, '', HOST, '');
}

function forgetMe (f) {
    deleteCookie('mtcmtmail', '', HOST);
    deleteCookie('mtcmthome', '', HOST);
    deleteCookie('mtcmtauth', '', HOST);
    f.email.value = '';
    f.author.value = '';
    f.url.value = '';
}

//-->
</script>



</head>

<body>

<div id="banner">
<h1><a href="http://www.perham.net/mike/log/" accesskey="1">Mutterings</a></h1>
<span class="description">Mike Perham's blog</span>
</div>

<div id="container">

<div class="blog">

<div id="menu">
<a href="http://www.perham.net/mike/log/archives/000174.html">&laquo; It's in the Middle there Somewhere...</a> |

<a href="http://www.perham.net/mike/log/">Main</a>
| <a href="http://www.perham.net/mike/log/archives/000176.html">Avoiding the Fuzz &raquo;</a>

</div>

</div>


<div class="blog">

<h2 class="date">August 09, 2004</h2>

<div class="blogbody">

<h3 class="title">Fun with .NET Web Service Clients</h3>

<p>I spent all day today teaching myself how to build a Web Service client using VB.NET.  Webify's technology is all Java-based on the server side but pretty much all of our customers are using .NET on the desktop to call our web services.  Unfortunately most of them are not incredibly tech-savvy, especially when it comes to cutting edge stuff like web services.  Thus they've been struggling to come on board while our deadline fast approaches...  &lt;cue omnious music&gt;  So I bit the bullet and spent the day figuring out how to call our services using VB.NET so we can provide them with working sample code to integrate with their systems.  </p>

<p>The actual web service is relatively straightforward - MS has good support for document/literal services so that was not a problem.  The problem was the SOAP headers we require to do authentication and service routing.  It turns out that adding custom SOAP headers to .NET is relatively straightforward - you just create a class which mocks the header.  For each element, create a property.  You use XML serialization attributes to control how those properties are serialized to XML (i.e. the local name and namespace).  Once I realized that, it was simple enough to create the headers we require.</p>

<a name="more"></a>


<span class="posted">Posted by mike at August  9, 2004 09:40 PM

<br /></span>

</div>


<div class="comments-head"><a name="comments"></a>Comments</div>

<div class="comments-body">
<p>You're a turd.</p>
<span class="comments-post">Posted by: <a href="mailto&#58;reader&#64;perham&#46;net">Reader</a> on August 10, 2004 03:53 PM</span>
</div>


<div class="comments-head">Post a comment</div>

<div class="comments-body">
<form method="post" action="http://www.perham.net/mike/log/mt-comment.cgi" name="comments_form" onsubmit="if (this.bakecookie.checked) rememberMe(this)">
<input type="hidden" name="static" value="1" />
<input type="hidden" name="entry_id" value="175" />

<label for="author">Name:</label><br />
<input id="author" name="author" /><br /><br />

<label for="email">Email Address:</label><br />
<input id="email" name="email" /><br /><br />

<label for="url">URL:</label><br />
<input id="url" name="url" /><br /><br />

<label for="text">Comments:</label><br />
<textarea id="text" name="text" rows="10" cols="50"></textarea><br /><br />

<input type="checkbox" id="bakecookie" name="bakecookie" /><label for="bakecookie">Remember info?</label><br /><br />

<input type="submit" name="preview" value="&nbsp;PREVIEW&nbsp;" />
<input type="submit" name="post" value="&nbsp;POST&nbsp;" /><br /><br />

<input type="button" onclick="forgetMe(this.form)" value="FORGET PERSONAL INFORMATION" />
</form>

<script type="text/javascript" language="javascript">
<!--
document.comments_form.email.value = getCookie("mtcmtmail");
document.comments_form.author.value = getCookie("mtcmtauth");
document.comments_form.url.value = getCookie("mtcmthome");
//-->
</script>


</div>
</div>
</body>
</html>
